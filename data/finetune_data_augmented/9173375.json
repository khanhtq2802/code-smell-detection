{"text": "<fim_prefix>\t\twriter.attribute( \"w:fareast\", \"ZH-CN\" );\n\t\twriter.attribute( \"w:bidi\", \"AR-SA\" );\n\t\twriter.closeTag( \"w:lang\" );\n\t\twriter.closeTag( \"w:rPr\" );\n\t\twriter.openTag( \"w:tblPr\" );\n\t\twriter.openTag( \"w:tblInd\" );\n\t\twriter.attribute( \"w:w\", 0 );\n\t\twriter.attribute( \"w:type\", \"dxa\" );\n\t\twriter.closeTag( \"w:tblInd\" );\n\t\twriter.openTag( \"w:tblCellMar\" );\n\t\twriter.openTag( \"w:top\" );\n\t\twriter.attribute( \"w:w\", 0 );\n\t\twriter.attribute( \"w:type\", \"dxa\" );\n\t\twriter.closeTag( \"w:top\" );\n\t\twriter.openTag( \"w:left\" );\n\t\twriter.attribute( \"w:w\", 108 );\n\t\twriter.attribute( \"w:type\", \"dxa\" );\n\t\twriter.closeTag( \"w:left\" );\n\t\twriter.openTag( \"w:bottom\" );\n\t\twriter.attribute( \"w:w\", 0 );\n\t\twriter.attribute( \"w:type\", \"dxa\" );\n\t\twriter.closeTag( \"w:bottom\" );\n\t\twriter.openTag( \"w:right\" );\n\t\twriter.attribute( \"w:w\", 108 );\n\t\twriter.attribute( \"w:type\", \"dxa\" );\n\t\twriter.closeTag( \"w:right\" );\n\t\twriter.closeTag( \"w:tblCellMar\" );\n\t\twriter.closeTag( \"w:tblPr\" );\n\t\twriter.closeTag( \"w:style\" );\n\t\twriter.closeTag( \"w:styles\" );\n\t\t// For show background\n\t\twriter.openTag( \"w:displayBackgroundShape\" );\n\t\twriter.closeTag( \"w:displayBackgroundShape\" );\n\t\twriter.openTag( \"w:docPr\" );\n\t\twriter.openTag( \"w:view\" );\n\t\twriter.attribute( \"w:val\", \"print\" );\n\t\twriter.closeTag( \"w:view\" );\n\t\twriter.openTag( \"w:zoom\" );\n\t\twriter.attribute( \"w:percent\", \"100\" );\n\t\twriter.closeTag( \"w:zoom\" );\n\t\twriter.closeTag( \"w:docPr\" );\n\t\twriter.openTag( \"w:body\" );\n\t}\n\tprivate void writeCoreProperties( String creator, String title,\n\t\t\tString description, String subject )\n\t{\n\t\twriter.openTag( \"o:DocumentProperties\" );\n\t\twriter.openTag( \"o:Author\" );\n\t\twriter.text( creator );\n\t\twriter.closeTag( \"o:Author\" );\n\t\twriter.openTag( \"o:Title\" );\n\t\twriter.text( title );\n\t\twriter.closeTag( \"o:Title\" );\n\t\twriter.openTag( \"o:Description\" );\n\t\twriter.text( description );\n\t\twriter.closeTag( \"o:Description\" );\n\t\twriter.openTag( \"o:Subject\" );\n\t\twriter.text( subject );\n\t\twriter.closeTag( \"o:Subject\" );\n\t\twriter.closeTag( \"o:DocumentProperties\" );\n\t}\n\t/**\n\t * \n\t * @param data\n\t *            image data\n\t * @param height\n\t *            image height, unit = pt\n\t * @param width\n\t *            image width, unit = pt\n\t */\n\tpublic void drawImage( byte[] data, double height, double width,\n\t\t\tHyperlinkInfo hyper, IStyle style, InlineFlag inlineFlag,\n\t\t\tString altText, String imageUrl )\n\t{\n\t\tif ( inlineFlag == InlineFlag.BLOCK\n\t\t\t\t|| inlineFlag == InlineFlag.FIRST_INLINE )\n\t\t{\n\t\t\twriter.openTag( \"w:p\" );\n\t\t}\n\t\tint imageId = getImageID( );\n\t\topenHyperlink( hyper );\n\t\twriter.openTag( \"w:r\" );\n\t\twriter.openTag( \"w:pict\" );\n\t\tdrawImageShapeType( imageId );\n\t\tdrawImageData( data, imageId );\n\t\tdrawImageShape( height, width, style, altText, imageId );\n\t\twriter.closeTag( \"w:pict\" );\n\t\twriter.closeTag( \"w:r\" );\n\t\tcloseHyperlink( hyper );\n\t\tif ( inlineFlag == InlineFlag.BLOCK )\n\t\t{\n\t\t\twriter.closeTag( \"w:p\" );\n\t\t}\n\t}\n\tprivate void drawImageData( byte[] data, int imageId )\n\t{\n\t\tString pic2Text = null;\n\t\tif ( data != null && data.length != 0 )\n\t\t{\n\t\t\tpic2Text = new String( Base64.encodeBase64( data, false ) );\n\t\t}\n\t\tif ( pic2Text != null )\n\t\t{\n\t\t\twriter.openTag( \"w:binData\" );\n\t\t\twriter.attribute( \"w:name\", \"wordml://\" + imageId + \".png\" );\n\t\t\twriter.text( pic2Text );\n\t\t\twriter.closeTag( \"w:binData\" );\n\t\t}\n\t}\n\tprivate void drawImageShape( double height, double width, IStyle style,\n\t\t\tString altText, int imageId )\n\t{\n\t\twriter.openTag( \"v:shape\" );\n\t\twriter.attribute( \"id\", \"_x0000_i10\" + imageId );\n\t\twriter.attribute( \"type\", \"#_x0000_t\" + imageId );\n\t\twriter.attribute( \"alt\", altText );\n\t\twriter.attribute( \"style\", \"width:\" + width + \"pt;height:\" + height\n\t\t\t\t+ \"pt\" );\n\t\tdrawImageBordersColor( style );\n\t\twriter.openTag( \"v:imagedata\" );\n\t\twriter.attribute( \"src\", \"wordml://\" + imageId + \".png\" );\n\t\twriter.attribute( \"otitle\", \"\" );\n\t\twriter.closeTag( \"v:imagedata\" );\n\t\tdrawImageBordersStyle( style );\n\t\twriter.closeTag( \"v:shape\" );\n\t}\n\tpublic void writeContent( int type, String txt, IStyle style,\n\t\t\tIStyle inlineStyle, String fontFamily, HyperlinkInfo info,\n\t\t\tInlineFlag inlineFlag, TextFlag flag, int paragraphWidth,\n\t\t\tboolean runIsRtl, String textAlign )\n\t{\n\t\tif ( inlineFlag == InlineFlag.BLOCK )\n\t\t{\n\t\t\twriteText( type, txt, style, fontFamily, info, flag, paragraphWidth,\n\t\t\t\t\trunIsRtl );\n\t\t}\n\t\telse\n\t\t{\n\t\t\tboolean isInline = true;\n\t\t\tif ( inlineFlag == InlineFlag.FIRST_INLINE\n\t\t\t\t\t&& flag == TextFlag.START )\n\t\t\t{\n\t\t\t\tstartParagraph( style, isInline, paragraphWidth, textAlign );\n\t\t\t}\n\t\t\tif ( inlineStyle != null )\n\t\t\t\twriteTextInRun( type, txt, inlineStyle, fontFamily, info,\n\t\t\t\t\t\tisInline, paragraphWidth, runIsRtl, textAlign );\n\t\t\telse\n\t\t\t\twriteTextInRun( type, txt, style, fontFamily, info, isInline,\n\t\t\t\t\t\tparagraphWidth, runIsRtl, textAlign );\n\t\t}\n\t}\n<fim_suffix>\tprotected void openHyperlink( HyperlinkInfo info )\n\t{\n\t\tif ( info == null )\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\twriter.openTag( \"w:hlink\" );\n\t\tif ( HyperlinkInfo.BOOKMARK == info.getType( ) )\n\t\t{\n\t\t\twriter.attribute( \"w:bookmark\", info.getUrl( ) );\n\t\t}\n\t\telse if ( HyperlinkInfo.HYPERLINK == info.getType( ) )\n\t\t{\n\t\t\twriter.attribute( \"w:dest\", info.getUrl( ) );\n\t\t\tif ( info.getBookmark( ) != null )\n\t\t\t{\n\t\t\t\twriter.attribute( \"w:bookmark\", info.getBookmark( ) );\n\t\t\t}\n\t\t}\n\t\tif ( info.getTooltip( ) != null )\n\t\t{\n\t\t\twriter.attribute( \"w:screenTip\", info.getTooltip( ) );\n\t\t}\n\t}<fim_middle>// function below has no smell\n"}
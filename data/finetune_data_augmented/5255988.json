{"text": "<fim_prefix>\n<fim_suffix>public class CoordActionQueryExecutor extends\n        QueryExecutor<CoordinatorActionBean, CoordActionQueryExecutor.CoordActionQuery> {\n    public enum CoordActionQuery {\n        UPDATE_COORD_ACTION,\n        UPDATE_COORD_ACTION_STATUS_PENDING_TIME,\n        UPDATE_COORD_ACTION_FOR_INPUTCHECK,\n        UPDATE_COORD_ACTION_FOR_PUSH_INPUTCHECK,\n        UPDATE_COORD_ACTION_DEPENDENCIES,\n        UPDATE_COORD_ACTION_FOR_START,\n        UPDATE_COORD_ACTION_FOR_MODIFIED_DATE,\n        UPDATE_COORD_ACTION_RERUN,\n        GET_COORD_ACTION,\n        GET_COORD_ACTION_STATUS,\n        GET_COORD_ACTIVE_ACTIONS_COUNT_BY_JOBID,\n        GET_COORD_ACTIONS_BY_LAST_MODIFIED_TIME,\n        GET_COORD_ACTIONS_STATUS_UNIGNORED,\n        GET_COORD_ACTIONS_PENDING_COUNT,\n        GET_ACTIVE_ACTIONS_IDS_FOR_SLA_CHANGE,\n        GET_ACTIVE_ACTIONS_JOBID_FOR_SLA_CHANGE,\n        GET_TERMINATED_ACTIONS_FOR_DATES,\n        GET_TERMINATED_ACTION_IDS_FOR_DATES,\n        GET_ACTIVE_ACTIONS_FOR_DATES,\n        GET_COORD_ACTIONS_WAITING_READY_SUBMITTED_OLDER_THAN,\n        GET_COORD_ACTIONS_FOR_RECOVERY_OLDER_THAN,\n        GET_COORD_ACTION_FOR_SLA,\n        GET_COORD_ACTION_FOR_INPUTCHECK\n    };\n    private static CoordActionQueryExecutor instance = new CoordActionQueryExecutor();\n    private CoordActionQueryExecutor() {\n    }\n    public static QueryExecutor<CoordinatorActionBean, CoordActionQueryExecutor.CoordActionQuery> getInstance() {\n        return CoordActionQueryExecutor.instance;\n    }\n    @Override\n    public Query getUpdateQuery(CoordActionQuery namedQuery, CoordinatorActionBean actionBean, EntityManager em)\n            throws JPAExecutorException {\n        Query query = em.createNamedQuery(namedQuery.name());\n        switch (namedQuery) {\n            case UPDATE_COORD_ACTION:\n                query.setParameter(\"actionNumber\", actionBean.getActionNumber());\n                query.setParameter(\"actionXml\", actionBean.getActionXmlBlob());\n                query.setParameter(\"consoleUrl\", actionBean.getConsoleUrl());\n                query.setParameter(\"createdConf\", actionBean.getCreatedConfBlob());\n                query.setParameter(\"errorCode\", actionBean.getErrorCode());\n                query.setParameter(\"errorMessage\", actionBean.getErrorMessage());\n                query.setParameter(\"externalStatus\", actionBean.getExternalStatus());\n                query.setParameter(\"missingDependencies\", actionBean.getMissingDependenciesBlob());\n                query.setParameter(\"runConf\", actionBean.getRunConfBlob());\n                query.setParameter(\"timeOut\", actionBean.getTimeOut());\n                query.setParameter(\"trackerUri\", actionBean.getTrackerUri());\n                query.setParameter(\"type\", actionBean.getType());\n                query.setParameter(\"createdTime\", actionBean.getCreatedTimestamp());\n                query.setParameter(\"externalId\", actionBean.getExternalId());\n                query.setParameter(\"jobId\", actionBean.getJobId());\n                query.setParameter(\"lastModifiedTime\", new Date());\n                query.setParameter(\"nominalTime\", actionBean.getNominalTimestamp());\n                query.setParameter(\"slaXml\", actionBean.getSlaXmlBlob());\n                query.setParameter(\"status\", actionBean.getStatus().toString());\n                query.setParameter(\"id\", actionBean.getId());\n                break;\n            case UPDATE_COORD_ACTION_STATUS_PENDING_TIME:\n                query.setParameter(\"status\", actionBean.getStatus().toString());\n                query.setParameter(\"pending\", actionBean.getPending());\n                query.setParameter(\"lastModifiedTime\", new Date());\n                query.setParameter(\"id\", actionBean.getId());\n                break;\n            case UPDATE_COORD_ACTION_FOR_INPUTCHECK:\n                query.setParameter(\"status\", actionBean.getStatus().toString());\n                query.setParameter(\"lastModifiedTime\", new Date());\n                query.setParameter(\"actionXml\", actionBean.getActionXmlBlob());\n                query.setParameter(\"missingDependencies\", actionBean.getMissingDependenciesBlob());\n                query.setParameter(\"id\", actionBean.getId());\n                break;\n            case UPDATE_COORD_ACTION_FOR_PUSH_INPUTCHECK:\n                query.setParameter(\"status\", actionBean.getStatus().toString());\n                query.setParameter(\"lastModifiedTime\", new Date());\n                query.setParameter(\"actionXml\", actionBean.getActionXmlBlob());\n                query.setParameter(\"pushMissingDependencies\", actionBean.getPushMissingDependenciesBlob());\n                query.setParameter(\"id\", actionBean.getId());\n                break;\n            case UPDATE_COORD_ACTION_DEPENDENCIES:\n                query.setParameter(\"missingDependencies\", actionBean.getMissingDependenciesBlob());\n                query.setParameter(\"pushMissingDependencies\", actionBean.getPushMissingDependenciesBlob());\n                query.setParameter(\"id\", actionBean.getId());\n                break;\n            case UPDATE_COORD_ACTION_FOR_START:\n                query.setParameter(\"status\", actionBean.getStatus().toString());\n                query.setParameter(\"lastModifiedTime\", new Date());\n                query.setParameter(\"runConf\", actionBean.getRunConfBlob());\n                query.setParameter(\"externalId\", actionBean.getExternalId());\n                query.setParameter(\"pending\", actionBean.getPending());\n                query.setParameter(\"errorCode\", actionBean.getErrorCode());\n                query.setParameter(\"errorMessage\", actionBean.getErrorMessage());\n                query.setParameter(\"id\", actionBean.getId());\n                break;\n            case UPDATE_COORD_ACTION_FOR_MODIFIED_DATE:\n                query.setParameter(\"lastModifiedTime\", actionBean.getLastModifiedTimestamp());\n                query.setParameter(\"id\", actionBean.getId());\n                break;\n            case UPDATE_COORD_ACTION_RERUN:\n                query.setParameter(\"actionXml\", actionBean.getActionXmlBlob());\n                query.setParameter(\"status\", actionBean.getStatusStr());\n                query.setParameter(\"externalId\", actionBean.getExternalId());\n                query.setParameter(\"externalStatus\", actionBean.getExternalStatus());\n                query.setParameter(\"rerunTime\", actionBean.getRerunTimestamp());\n                query.setParameter(\"lastModifiedTime\", actionBean.getLastModifiedTimestamp());\n                query.setParameter(\"createdTime\", actionBean.getCreatedTimestamp());\n                query.setParameter(\"createdConf\", actionBean.getCreatedConfBlob());\n                query.setParameter(\"runConf\", actionBean.getRunConfBlob());\n                query.setParameter(\"missingDependencies\", actionBean.getMissingDependenciesBlob());\n                query.setParameter(\"pushMissingDependencies\", actionBean.getPushMissingDependenciesBlob());\n                query.setParameter(\"errorCode\", actionBean.getErrorCode());\n                query.setParameter(\"errorMessage\", actionBean.getErrorMessage());\n                query.setParameter(\"id\", actionBean.getId());\n                break;\n            default:\n                throw new JPAExecutorException(ErrorCode.E0603, \"QueryExecutor cannot set parameters for \"\n                        + namedQuery.name());\n        }\n        return query;\n    }\n    @Override\n    public Query getSelectQuery(CoordActionQuery namedQuery, EntityManager em, Object... parameters)\n            throws JPAExecutorException {\n        Query query = em.createNamedQuery(namedQuery.name());\n        CoordActionQuery caQuery = (CoordActionQuery) namedQuery;\n        switch (caQuery) {\n            case GET_COORD_ACTION:\n            case GET_COORD_ACTION_STATUS:\n            case GET_COORD_ACTION_FOR_SLA:\n            case GET_COORD_ACTION_FOR_INPUTCHECK:\n                query.setParameter(\"id\", parameters[0]);\n                break;\n            case GET_COORD_ACTIONS_BY_LAST_MODIFIED_TIME:\n                query.setParameter(\"lastModifiedTime\", new Timestamp(((Date) parameters[0]).getTime()));\n                break;\n            case GET_COORD_ACTIONS_STATUS_UNIGNORED:\n                query.setParameter(\"jobId\", parameters[0]);\n                break;\n            case GET_COORD_ACTIONS_PENDING_COUNT:\n                query.setParameter(\"jobId\", parameters[0]);\n                break;\n            case GET_ACTIVE_ACTIONS_IDS_FOR_SLA_CHANGE:\n            query.setParameter(\"ids\", parameters[0]);\n            break;\n            case GET_ACTIVE_ACTIONS_JOBID_FOR_SLA_CHANGE:\n            query.setParameter(\"jobId\", parameters[0]);\n            break;\n            case GET_TERMINATED_ACTIONS_FOR_DATES:\n            case GET_TERMINATED_ACTION_IDS_FOR_DATES:\n            case GET_ACTIVE_ACTIONS_FOR_DATES:\n                query.setParameter(\"jobId\", parameters[0]);\n                query.setParameter(\"startTime\", new Timestamp(((Date) parameters[1]).getTime()));\n                query.setParameter(\"endTime\", new Timestamp(((Date) parameters[2]).getTime()));\n                break;\n            case GET_COORD_ACTIONS_FOR_RECOVERY_OLDER_THAN:\n                query.setParameter(\"lastModifiedTime\", new Timestamp(((Date) parameters[0]).getTime()));\n                break;\n            case GET_COORD_ACTIONS_WAITING_READY_SUBMITTED_OLDER_THAN:\n                query.setParameter(\"lastModifiedTime\", new Timestamp(((Date) parameters[0]).getTime()));\n                query.setParameter(\"currentTime\", new Timestamp(new Date().getTime()));\n                break;\n            default:\n                throw new JPAExecutorException(ErrorCode.E0603, \"QueryExecutor cannot set parameters for \"\n                        + caQuery.name());<fim_middle>// class below is blob\n"}
{"text": "<fim_prefix>//\n//  ========================================================================\n//  Copyright (c) 1995-2019 Mort Bay Consulting Pty. Ltd.\n//  ------------------------------------------------------------------------\n//  All rights reserved. This program and the accompanying materials\n//  are made available under the terms of the Eclipse Public License v1.0\n//  and Apache License v2.0 which accompanies this distribution.\n//\n//      The Eclipse Public License is available at\n//      http://www.eclipse.org/legal/epl-v10.html\n//\n//      The Apache License v2.0 is available at\n//      http://www.opensource.org/licenses/apache2.0.php\n//\n//  You may elect to redistribute this code under either of these licenses.\n//  ========================================================================\n//\n\npackage org.eclipse.jetty.embedded;\n\nimport java.lang.management.ManagementFactory;\n\nimport org.eclipse.jetty.jmx.MBeanContainer;\nimport org.eclipse.jetty.server.Server;\nimport org.eclipse.jetty.server.ServerConnectionStatistics;\nimport org.eclipse.jetty.servlet.DefaultServlet;\nimport org.eclipse.jetty.servlet.ServletContextHandler;\n\n<fim_suffix>public class OneServletContextJmxStats\n{\n    public static void main( String[] args ) throws Exception\n    {\n        Server server = new Server(8080);\n        // Add JMX tracking to Server\n        server.addBean(new MBeanContainer(ManagementFactory\n                .getPlatformMBeanServer()));\n\n        ServletContextHandler context = new ServletContextHandler(\n                ServletContextHandler.SESSIONS);\n        context.setContextPath(\"/\");\n        server.setHandler(context);\n\n        context.addServlet(DumpServlet.class, \"/dump/*\");\n        context.addServlet(DefaultServlet.class, \"/\");\n\n        // Add Connector Statistics tracking to all connectors\n        ServerConnectionStatistics.addToAllConnectors(server);\n\n        server.start();\n        server.join();\n    }\n}<fim_middle>// class below has no smell\n"}
{"text": "<fim_prefix>/*\n * Copyright (c) 2011 Google Inc.\n *\n * All rights reserved. This program and the accompanying materials are made available under the terms of the Eclipse\n * Public License v1.0 which accompanies this distribution, and is available at\n *\n * http://www.eclipse.org/legal/epl-v10.html\n */\npackage com.google.eclipse.protobuf.junit.core;\n\nimport static java.util.regex.Pattern.compile;\n\nimport static com.google.eclipse.protobuf.junit.core.GeneratedProtoFiles.ensureParentDirectoryExists;\nimport static com.google.eclipse.protobuf.junit.core.GeneratedProtoFiles.protoFile;\n\nimport java.io.File;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.OutputStreamWriter;\nimport java.io.Writer;\nimport java.util.Scanner;\nimport java.util.regex.Matcher;\nimport java.util.regex.Pattern;\n\n/**\n * @author alruiz@google.com (Alex Ruiz)\n */\n<fim_suffix>class FileCreator {\n  private static final Pattern CREATE_FILE_PATTERN = compile(\"// Create file (.*)\");\n\n  File createFileFrom(String comment) {\n    String fileName = null;\n    try (Scanner scanner = new Scanner(comment)) {\n\t    while (scanner.hasNextLine()) {\n\t      String line = scanner.nextLine();\n\t      Matcher matcher = CREATE_FILE_PATTERN.matcher(line);\n\t      if (!matcher.matches()) {\n\t        return null;\n\t      }\n\t      fileName = matcher.group(1);\n\t      break;\n\t    }\n    }\n    return createFile(fileName, comment);\n  }\n\n  private File createFile(String fileName, String contents) {\n    ensureParentDirectoryExists();\n    File file = protoFile(fileName);\n    if (file.isFile()) {\n      file.delete();\n    }\n    Writer out = null;\n    try {\n      out = new OutputStreamWriter(new FileOutputStream(file));\n      out.write(contents);\n    } catch (IOException e) {\n      e.printStackTrace();\n    } finally {\n      closeQuietly(out);\n    }\n    return file;\n  }\n\n  private void closeQuietly(Writer out) {\n    if (out == null) {\n      return;\n    }\n    try {\n      out.close();\n    } catch (IOException e) {}\n  }\n}<fim_middle>// class below has no smell\n"}
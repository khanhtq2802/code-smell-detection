{"text": "<fim_prefix>/*\nCopyright 2011-2016 Google Inc. All Rights Reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\npackage com.google.security.zynamics.binnavi.API.helpers;\n\nimport java.awt.Window;\n\n\nimport com.google.common.base.Preconditions;\nimport com.google.security.zynamics.binnavi.Gui.CProgressDialog;\nimport com.google.security.zynamics.zylib.gui.ProgressDialogs.CEndlessHelperThread;\n\n// / Progress dialog class\n/**\n * This class can be used to display a progress dialog while long operations are running.\n */\n<fim_suffix>public final class ProgressDialog {\n  /**\n   * Do not create objects of this class.\n   */\n  private ProgressDialog() {\n    // You are not supposed to instantiate this class\n  }\n\n  // ! Shows a progress dialog.\n  /**\n   * Shows a progress dialog.\n   *\n   * @param parent The parent window of the progress dialog.\n   * @param title The title of the progress dialog.\n   * @param thread The thread which implements the long-running operation.\n   *\n   * @return The exception thrown during the execution of IProgressThread::run or null if no\n   *         exception was thrown.\n   */\n  public static Exception show(\n      final Window parent, final String title, final IProgressThread thread) {\n    Preconditions.checkNotNull(thread, \"Error: Thread argument can't be null\");\n\n    final EndlessHelperWrapper helperThread = new EndlessHelperWrapper(thread);\n\n    CProgressDialog.showEndless(parent, title, helperThread);\n\n    return helperThread.getException();\n  }\n\n  /**\n   * Wraps endless helper threads.\n   */\n  private static class EndlessHelperWrapper extends CEndlessHelperThread {\n    /**\n     * The wrapped API thread object.\n     */\n    private final IProgressThread m_thread;\n\n    /**\n     * Creates a new wrapper object.\n     *\n     * @param thread The wrapped API thread object.\n     */\n    private EndlessHelperWrapper(final IProgressThread thread) {\n      m_thread = thread;\n    }\n\n    @Override\n    protected void runExpensiveCommand() throws Exception {\n      m_thread.run();\n    }\n\n    @Override\n    public void closeRequested() {\n      if (m_thread.close()) {\n        finish();\n      }\n    }\n  }\n}<fim_middle>// class below has no smell\n"}
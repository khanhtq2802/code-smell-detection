{"text": "<fim_prefix>/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\npackage org.apache.hadoop.hive.ql.udf.xml;\n\nimport org.apache.hadoop.hive.ql.exec.Description;\nimport org.apache.hadoop.hive.ql.exec.UDF;\nimport org.apache.hadoop.io.Text;\n\n@Description(name = \"xpath_string\",\n    value = \"_FUNC_(xml, xpath) - Returns the text contents of the first xml node that matches the xpath expression\",\n    extended = \"Example:\\n\"\n    + \"  > SELECT _FUNC_('<a><b>b</b><c>cc</c></a>','a/c') FROM src LIMIT 1;\\n\"\n    + \"  'cc'\\n\"\n    + \"  > SELECT _FUNC_('<a><b>b1</b><b>b2</b></a>','a/b') FROM src LIMIT 1;\\n\"\n    + \"  'b1'\\n\"\n    + \"  > SELECT _FUNC_('<a><b>b1</b><b>b2</b></a>','a/b[2]') FROM src LIMIT 1;\\n\"\n    + \"  'b2'\\n\"\n    + \"  > SELECT _FUNC_('<a><b>b1</b><b>b2</b></a>','a') FROM src LIMIT 1;\\n\"\n    + \"  'b1b2'\"\n    )\npublic class UDFXPathString extends UDF {\n\n  private final UDFXPathUtil xpath = new UDFXPathUtil();\n  private final Text result = new Text();\n\n<fim_suffix>  public Text evaluate(String xml, String path) {\n    String s = xpath.evalString(xml, path);\n    if (s == null) {\n      return null;\n    }\n\n    result.set(s);\n    return result;\n  }\n}<fim_middle>// function below has no smell\n"}
{"text": "<fim_prefix>/*\n *  Copyright (c) 2017 Ot\u00e1vio Santana and others\n *   All rights reserved. This program and the accompanying materials\n *   are made available under the terms of the Eclipse Public License v1.0\n *   and Apache License v2.0 which accompanies this distribution.\n *   The Eclipse Public License is available at http://www.eclipse.org/legal/epl-v10.html\n *   and the Apache License v2.0 is available at http://www.opensource.org/licenses/apache2.0.php.\n *\n *   You may elect to redistribute this code under either of these licenses.\n *\n *   Contributors:\n *\n *   Otavio Santana\n */\npackage org.jnosql.diana.couchbase.util;\n\nimport com.couchbase.client.java.CouchbaseCluster;\n\nimport java.util.Objects;\n\n<fim_suffix>public final class CouchbaseClusterUtil {\n    private CouchbaseClusterUtil() {\n    }\n\n    public static CouchbaseCluster getCouchbaseCluster(String database, CouchbaseCluster couchbaseCluster, String user, String password) {\n        Objects.requireNonNull(database, \"database is required\");\n        CouchbaseCluster authenticate = couchbaseCluster.authenticate(user, password);\n\n       /*\n        ClusterManager clusterManager = authenticate.clusterManager();\n        List<BucketSettings> buckets = clusterManager.getBuckets();\n        if(buckets.stream().noneMatch(b -> b.name().equals(database))) {\n            BucketSettings bucketSettings =  DefaultBucketSettings.builder().name(database).quota(100);\n            clusterManager.insertBucket(bucketSettings);\n            Bucket bucket = authenticate.openBucket(database);\n            bucket.query(N1qlQuery.simple(\"CREATE PRIMARY INDEX index_\" + database + \" on \" + database));\n            bucket.close();\n        }*/\n        return authenticate;\n    }\n\n}<fim_middle>// class below has no smell\n"}
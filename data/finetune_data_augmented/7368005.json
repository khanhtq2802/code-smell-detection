{"text": "<fim_prefix>// Copyright (c) Microsoft. All rights reserved.\n// Licensed under the MIT license. See License.txt in the repository root.\n\npackage com.microsoft.tfs.client.common.ui.teambuild.commands;\n\nimport org.eclipse.core.runtime.IProgressMonitor;\nimport org.eclipse.core.runtime.IStatus;\nimport org.eclipse.core.runtime.Status;\n\nimport com.microsoft.tfs.client.common.commands.TFSCommand;\nimport com.microsoft.tfs.client.common.ui.teambuild.Messages;\nimport com.microsoft.tfs.core.clients.build.IBuildServer;\nimport com.microsoft.tfs.core.clients.build.internal.TeamBuildCache;\nimport com.microsoft.tfs.util.Check;\nimport com.microsoft.tfs.util.LocaleUtil;\n\n<fim_suffix>public class AddRemoveBuildQualitiesCommand extends TFSCommand {\n\n    private final IBuildServer buildServer;\n    private final String teamProject;\n    private final String[] qualitiesToAdd;\n    private final String[] qualitiesToRemove;\n\n    public AddRemoveBuildQualitiesCommand(\n        final IBuildServer buildServer,\n        final String teamProject,\n        final String[] qualitiesToAdd,\n        final String[] qualitiesToRemove) {\n        Check.notNull(buildServer, \"buildServer\"); //$NON-NLS-1$\n        Check.notNullOrEmpty(teamProject, \"teamProject\"); //$NON-NLS-1$\n        Check.notNull(qualitiesToAdd, \"qualitiesToAdd\"); //$NON-NLS-1$\n        Check.notNull(qualitiesToRemove, \"qualitiesToRemove\"); //$NON-NLS-1$\n\n        this.buildServer = buildServer;\n        this.teamProject = teamProject;\n        this.qualitiesToAdd = qualitiesToAdd;\n        this.qualitiesToRemove = qualitiesToRemove;\n    }\n\n    @Override\n    public String getName() {\n        return Messages.getString(\"AddRemoveBuildQualitiesCommand.EditBuildQualityCommandText\"); //$NON-NLS-1$\n    }\n\n    @Override\n    public String getErrorDescription() {\n        return Messages.getString(\"AddRemoveBuildQualitiesCommand.EditBuildQualityErrorText\"); //$NON-NLS-1$\n\n    }\n\n    @Override\n    public String getLoggingDescription() {\n        return Messages.getString(\"AddRemoveBuildQualitiesCommand.EditBuildQualityCommandText\", LocaleUtil.ROOT); //$NON-NLS-1$\n    }\n\n    /**\n     * @see com.microsoft.tfs.client.common.framework.command.Command#doRun(org.eclipse.core.runtime.IProgressMonitor)\n     */\n    @Override\n    protected IStatus doRun(final IProgressMonitor progressMonitor) throws Exception {\n        if (qualitiesToAdd.length > 0) {\n            buildServer.addBuildQuality(teamProject, qualitiesToAdd);\n        }\n        if (qualitiesToRemove.length > 0) {\n            buildServer.deleteBuildQuality(teamProject, qualitiesToRemove);\n        }\n\n        // Force re-population of cache.\n        TeamBuildCache.getInstance(buildServer, teamProject).getBuildQualities(true);\n\n        return Status.OK_STATUS;\n    }\n}<fim_middle>// class below has no smell\n"}
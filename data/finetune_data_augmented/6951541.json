{"text": "<fim_prefix>/**\n * Copyright (c) 2016 NumberFour AG.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *   NumberFour AG - Initial API and implementation\n */\npackage org.eclipse.n4js.ui.wizard.project;\n\nimport org.eclipse.jface.dialogs.IDialogSettings;\nimport org.eclipse.jface.resource.ImageDescriptor;\nimport org.eclipse.n4js.projectDescription.ProjectType;\nimport org.eclipse.n4js.ui.ImageDescriptorCache.ImageRef;\nimport org.eclipse.n4js.ui.internal.N4JSActivator;\nimport org.eclipse.swt.widgets.Composite;\nimport org.eclipse.xtext.resource.IResourceDescriptions;\nimport org.eclipse.xtext.ui.wizard.IProjectCreator;\nimport org.eclipse.xtext.ui.wizard.IProjectInfo;\nimport org.eclipse.xtext.ui.wizard.XtextNewProjectWizard;\n\nimport com.google.inject.Inject;\n\n/**\n * Project wizard that creates a new N4JS Project.\n *\n * Provides controls for project name, project type, optional additional project options and working set selection.\n */\n<fim_suffix>public class N4JSNewProjectWizard extends XtextNewProjectWizard {\n\n\tprivate static final ImageDescriptor NEW_PROJECT_WIZBAN_DESC = ImageRef.NEW_PROJECT_WIZBAN.asImageDescriptor()\n\t\t\t.orNull();\n\n\tprivate static final String DIALOG_SETTINGS_SECTION_KEY = \"org.eclipse.n4js.ui.wizard.project.N4JSNewProjectWizard.dialogSettings\";\n\tprivate static final String CREATE_GREETER_SETTINGS_KEY = \"createGreeterFile\";\n\tprivate static final String VENDOR_ID_SETTINGS_KEY = \"vendorId\";\n\n\tprivate final N4JSProjectInfo projectInfo;\n\n\t@Inject\n\tprivate IResourceDescriptions resourceDescriptions;\n\n\tprivate N4JSNewProjectWizardCreationPage newProjectWizardCreationPage;\n\n\t/**\n\t * Creates a new wizard container for creating and initializing a new N4JS project into the workspace.\n\t *\n\t * @param projectCreator\n\t *            the project creation logic to be triggered when finishing this wizard.\n\t */\n\t@Inject\n\tpublic N4JSNewProjectWizard(final IProjectCreator projectCreator) {\n\t\tsuper(projectCreator);\n\t\tsetWindowTitle(\"New N4JS Project\");\n\t\tsetNeedsProgressMonitor(true);\n\t\tsetDefaultPageImageDescriptor(NEW_PROJECT_WIZBAN_DESC);\n\t\tprojectInfo = new N4JSProjectInfo();\n\n\t\t// Setup the dialog settings\n\t\tIDialogSettings workbenchDialogSettings = N4JSActivator.getInstance().getDialogSettings();\n\n\t\tIDialogSettings projectWizardSettings = workbenchDialogSettings.getSection(DIALOG_SETTINGS_SECTION_KEY);\n\t\tif (null == projectWizardSettings) {\n\t\t\tprojectWizardSettings = workbenchDialogSettings.addNewSection(DIALOG_SETTINGS_SECTION_KEY);\n\t\t}\n\t\tsetDialogSettings(projectWizardSettings);\n\t}\n\n\t@Override\n\tpublic void createPageControls(Composite pageContainer) {\n\t\tsuper.createPageControls(pageContainer);\n\n\t\tIDialogSettings dialogSettings = this.getDialogSettings();\n\n\t\tif (null != dialogSettings.get(CREATE_GREETER_SETTINGS_KEY)) {\n\t\t\tprojectInfo.setCreateGreeterFile(dialogSettings.getBoolean(CREATE_GREETER_SETTINGS_KEY));\n\t\t}\n\t\tif (null != dialogSettings.get(VENDOR_ID_SETTINGS_KEY)) {\n\t\t\tprojectInfo.setVendorId(dialogSettings.get(VENDOR_ID_SETTINGS_KEY));\n\t\t}\n\t}\n\n\t@Override\n\tpublic void addPages() {\n\t\tnewProjectWizardCreationPage = new N4JSNewProjectWizardCreationPage(projectInfo);\n\t\taddPage(newProjectWizardCreationPage);\n\t\taddPage(new N4JSTestedProjectWizardPage(projectInfo, resourceDescriptions));\n\t}\n\n\t@Override\n\tpublic boolean performFinish() {\n\t\t// Save the value for the create greeter file checkbox and the vendor id\n\t\tthis.getDialogSettings().put(CREATE_GREETER_SETTINGS_KEY, projectInfo.getCreateGreeterFile());\n\t\tthis.getDialogSettings().put(VENDOR_ID_SETTINGS_KEY, projectInfo.getVendorId());\n\t\treturn super.performFinish();\n\t}\n\n\t@Override\n\tpublic boolean canFinish() {\n\t\t/*\n\t\t * Can finish after first page for non-test projects or like normally if all pages are complete for test\n\t\t * projects\n\t\t *\n\t\t * This means that even for test projects the whole second page can be completely skipped.\n\t\t */\n\t\treturn (!ProjectType.TEST.equals(projectInfo.getProjectType()) &&\n\t\t\t\tnewProjectWizardCreationPage.isPageComplete()) || super.canFinish();\n\t}\n\n\t@Override\n\tprotected IProjectInfo getProjectInfo() {\n\t\t// update workingsets:\n\t\tnewProjectWizardCreationPage.updateSelectedWorkingSets();\n\n\t\treturn projectInfo;\n\t}\n}<fim_middle>// class below has no smell\n"}
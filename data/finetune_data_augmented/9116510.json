{"text": "<fim_prefix>\t\t\t\t        .substring( split + 1, resolution.length( ) ).trim( ) );\n\t\t\t\tif ( xResolution > 0 && yResolution > 0 )\n\t\t\t\t{\n\t\t\t\t\tout.println( \"%%BeginFeature: *Resolution \" + xResolution\n\t\t\t\t\t        + \"x\" + yResolution + \"dpi\" );\n\t\t\t\t\tout.println( \" << /HWResolution [\" + xResolution + \" \"\n\t\t\t\t\t        + yResolution + \"]\" );\n\t\t\t\t\tout.println( \"  /Policies << /HWResolution 2 >>\" );\n\t\t\t\t\tout.println( \" >> setpagedevice\" );\n\t\t\t\t\tout.println( \"%%EndFeature\" );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprivate void setGray( boolean color )\n\t{\n\t\tif ( !color )\n\t\t{\n\t\t\tout.println( \"%%BeginFeature: *HPColorAsGray true\" );\n\t\t\tout.println( \"<</ProcessColorModel /DeviceGray>> setpagedevice\" );\n\t\t\tout.println( \"%%EndFeature\" );\n\t\t}\n\t}\n\tprivate void setScale( int height, int scale )\n\t{\n\t\tif ( scale != 100 )\n\t\t{\n\t\t\tfloat absoluteScale = scale / 100f;\n\t\t\tfloat yOffset = height * ( 1 - absoluteScale );\n\t\t\tout.println( \"/mysetup [ \" + absoluteScale + \" 0 0 \"\n\t\t\t        + absoluteScale + \" 0 \" + yOffset + \"] def\" );\n\t\t\tout.println( \"mysetup concat\" );\n\t\t}\n\t}\n\tprivate int[] getPaperSize( String paperSize )\n\t{\n\t\tif ( paperSize == null || paperSize.trim( ).length( ) == 0 )\n\t\t\treturn null;\n\t\tint width = 595;\n\t\tint height = 842;\n\t\tif ( \"Letter\".equalsIgnoreCase( paperSize ) )\n\t\t{\n\t\t\twidth = 612;\n\t\t\theight = 792;\n\t\t}\n\t\telse if ( \"Legal\".equalsIgnoreCase( paperSize ) )\n\t\t{\n\t\t\twidth = 612;\n\t\t\theight = 1008;\n\t\t}\n\t\telse if ( \"A5\".equalsIgnoreCase( paperSize ) )\n\t\t{\n\t\t\twidth = 419;\n\t\t\theight = 595;\n\t\t}\n\t\telse if ( \"A4\".equalsIgnoreCase( paperSize ) )\n\t\t{\n\t\t\twidth = 595;\n\t\t\theight = 842;\n\t\t}\n\t\telse if ( \"A3\".equalsIgnoreCase( paperSize ) )\n\t\t{\n\t\t\twidth = 842;\n\t\t\theight = 1191;\n\t\t}\n\t\telse if ( \"B5\".equalsIgnoreCase( paperSize ) )\n\t\t{\n\t\t\twidth = 499;\n\t\t\theight = 709;\n\t\t}\n\t\telse if ( \"B4\".equalsIgnoreCase( paperSize ) )\n\t\t{\n\t\t\twidth = 729;\n\t\t\theight = 1032;\n\t\t}\n\t\treturn new int[]{width, height};\n\t}\n\tpublic void fillPage( Color color )\n\t{\n\t\tif ( color == null )\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tgSave( );\n\t\tsetColor( color );\n\t\tout.println( \"clippath fill\" );\n\t\tgRestore( );\n\t}\n\t/*\n\t * (non-Javadoc)\n\t * \n\t * @see\n\t * org.eclipse.birt.report.engine.emitter.postscript.IWriter#startPage(float\n\t * , float)\n\t */\n\tpublic void startPage( float pageWidth, float pageHeight, String orientation )\n\t{\n\t\tboolean isLandscape = isLandscape( orientation );\n\t\tboolean paperChanged = this.pageHeight == pageHeight\n\t\t        && this.pageWidth == pageWidth\n\t\t        && isLandscape == isLandscape( this.orientation );\n\t\tthis.orientation = orientation;\n\t\tthis.pageHeight = pageHeight;\n\t\tthis.pageWidth = pageWidth;\n\t\tout.println( \"%%Page: \" + pageIndex + \" \" + pageIndex );\n\t\tif ( autoPaperSizeSelection && ( !isDuplex || paperChanged ) )\n\t\t{\n\t\t\tif ( isLandscape )\n\t\t\t{\n\t\t\t\tsetPaperSize( \"auto\", (int) pageHeight, (int) pageWidth );\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsetPaperSize( \"auto\", (int) pageWidth, (int) pageHeight );\n\t\t\t}\n\t\t}\n\t\tout.println( \"%%PageBoundingBox: 0 0 \" + (int) Math.round( pageWidth )\n\t\t        + \" \" + (int) Math.round( pageHeight ) );\n\t\tout.println( \"%%BeginPage\" );\n\t\tif ( fitToPaper && paperWidth != 0 && paperHeight != 0 )\n\t\t{\n\t\t\tint height = isLandscape ? (int) pageWidth : (int) pageHeight;\n\t\t\tint width = isLandscape ? (int) pageHeight : (int) pageWidth;\n\t\t\tout.println( paperWidth + \" \" + width + \" div \" + paperHeight + \" \"\n\t\t\t        + height + \" div 2 copy gt {exch}if pop dup scale\" );\n\t\t}\n\t\tif ( isLandscape )\n\t\t{\n\t\t\tgSave( );\n\t\t\tout.println( \"90 rotate\" );\n\t\t\tout.println( \"1 -1 scale\" );\n\t\t\tout.print( \"[1 0 0 -1 0 \" );\n\t\t\tout.println( pageHeight + \"] concat\" );\n\t\t}\n\t\tsetScale( (int) pageHeight, scale );\n\t\t++pageIndex;\n\t}\n\tpublic boolean isLandscape( String orientation )\n\t{\n\t\tboolean isLandscape = orientation != null\n\t\t        && orientation.equalsIgnoreCase( \"Landscape\" );\n\t\treturn isLandscape;\n\t}\n\t/*\n\t * (non-Javadoc)\n\t * \n\t * @see org.eclipse.birt.report.engine.emitter.postscript.IWriter#endPage()\n\t */\n\tpublic void endPage( )\n\t{\n\t\tif ( orientation != null && orientation.equalsIgnoreCase( \"Landscape\" ) )\n\t\t{\n\t\t\tgRestore( );\n\t\t}\n\t\tout.println( \"showpage\" );\n\t\tout.println( \"%%PageTrailer\" );\n\t\tout.println( \"%%EndPage\" );\n\t}\n\t/*\n\t * (non-Javadoc)\n\t * \n\t * @see\n\t * org.eclipse.birt.report.engine.emitter.postscript.IWriter#stopRenderer()\n\t */\n\tpublic void stopRenderer( ) throws IOException\n\t{\n\t\tout.println( \"%%Trailer\" );\n\t\tout.println( \"%%Pages: \" + ( pageIndex - 1 ) );\n\t\tout.println( \"%%EOF\" );\n\t\tout.flush( );\n\t}\n\tpublic abstract class ImageSource\n\t{\n\t\tprotected int height;\n\t\tprotected int width;\n\t\tpublic ImageSource( int width, int height )\n\t\t{\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\t\t}\n\t\tpublic int getHeight( )\n\t\t{\n\t\t\treturn height;\n\t\t}\n\t\tpublic int getWidth( )\n\t\t{\n\t\t\treturn width;\n\t\t}\n\t\tpublic abstract int getRGB( int x, int y );\n\t}\n<fim_suffix>\tpublic class ArrayImageSource extends ImageSource\n\t{\n\t\tprivate int[] imageSource;\n\t\tpublic ArrayImageSource( int width, int height, int[] imageSource )\n\t\t{\n\t\t\tsuper( width, height );\n\t\t\tthis.imageSource = imageSource;\n\t\t}\n\t\tpublic int getRGB( int x, int y )\n\t\t{\n\t\t\treturn imageSource[y * width + x];\n\t\t}\n\t\tpublic int[] getData( )\n\t\t{\n\t\t\treturn imageSource;\n\t\t}\n\t}<fim_middle>// class below has no smell\n"}
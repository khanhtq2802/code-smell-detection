{"text": "<fim_prefix>    }\n    @Test\n    public void testBug55843() throws IOException {\n        try (Workbook wb = _testDataProvider.createWorkbook()) {\n            Sheet sheet = wb.createSheet(\"test\");\n            Row row = sheet.createRow(0);\n            Row row2 = sheet.createRow(1);\n            Cell cellA2 = row2.createCell(0, CellType.FORMULA);\n            Cell cellB1 = row.createCell(1, CellType.NUMERIC);\n            cellB1.setCellValue(10);\n            FormulaEvaluator formulaEvaluator = wb.getCreationHelper().createFormulaEvaluator();\n            cellA2.setCellFormula(\"IF(B1=0,\\\"\\\",((ROW()-ROW(A$1))*12))\");\n            CellValue evaluate = formulaEvaluator.evaluate(cellA2);\n            assertEquals(\"12.0\", evaluate.formatAsString());\n            cellA2.setCellFormula(\"IF(NOT(B1=0),((ROW()-ROW(A$1))*12),\\\"\\\")\");\n            CellValue evaluateN = formulaEvaluator.evaluate(cellA2);\n            assertEquals(evaluate.toString(), evaluateN.toString());\n            assertEquals(\"12.0\", evaluateN.formatAsString());\n        }\n    }\n    @Test\n    public void testBug55843a() throws IOException {\n        try (Workbook wb = _testDataProvider.createWorkbook()) {\n            Sheet sheet = wb.createSheet(\"test\");\n            Row row = sheet.createRow(0);\n            Row row2 = sheet.createRow(1);\n            Cell cellA2 = row2.createCell(0, CellType.FORMULA);\n            Cell cellB1 = row.createCell(1, CellType.NUMERIC);\n            cellB1.setCellValue(10);\n            FormulaEvaluator formulaEvaluator = wb.getCreationHelper().createFormulaEvaluator();\n            cellA2.setCellFormula(\"IF(B1=0,\\\"\\\",((ROW(A$1))))\");\n            CellValue evaluate = formulaEvaluator.evaluate(cellA2);\n            assertEquals(\"1.0\", evaluate.formatAsString());\n            cellA2.setCellFormula(\"IF(NOT(B1=0),((ROW(A$1))),\\\"\\\")\");\n            CellValue evaluateN = formulaEvaluator.evaluate(cellA2);\n            assertEquals(evaluate.toString(), evaluateN.toString());\n            assertEquals(\"1.0\", evaluateN.formatAsString());\n        }\n    }\n    @Test\n    public void testBug55843b() throws IOException {\n        try (Workbook wb = _testDataProvider.createWorkbook()) {\n            Sheet sheet = wb.createSheet(\"test\");\n            Row row = sheet.createRow(0);\n            Row row2 = sheet.createRow(1);\n            Cell cellA2 = row2.createCell(0, CellType.FORMULA);\n            Cell cellB1 = row.createCell(1, CellType.NUMERIC);\n            cellB1.setCellValue(10);\n            FormulaEvaluator formulaEvaluator = wb.getCreationHelper().createFormulaEvaluator();\n            cellA2.setCellFormula(\"IF(B1=0,\\\"\\\",((ROW())))\");\n            CellValue evaluate = formulaEvaluator.evaluate(cellA2);\n            assertEquals(\"2.0\", evaluate.formatAsString());\n            cellA2.setCellFormula(\"IF(NOT(B1=0),((ROW())),\\\"\\\")\");\n            CellValue evaluateN = formulaEvaluator.evaluate(cellA2);\n            assertEquals(evaluate.toString(), evaluateN.toString());\n            assertEquals(\"2.0\", evaluateN.formatAsString());\n        }\n    }\n    @Test\n    public void testBug55843c() throws IOException {\n        try (Workbook wb = _testDataProvider.createWorkbook()) {\n            Sheet sheet = wb.createSheet(\"test\");\n            Row row = sheet.createRow(0);\n            Row row2 = sheet.createRow(1);\n            Cell cellA2 = row2.createCell(0, CellType.FORMULA);\n            Cell cellB1 = row.createCell(1, CellType.NUMERIC);\n            cellB1.setCellValue(10);\n            FormulaEvaluator formulaEvaluator = wb.getCreationHelper().createFormulaEvaluator();\n            cellA2.setCellFormula(\"IF(NOT(B1=0),((ROW())))\");\n            CellValue evaluateN = formulaEvaluator.evaluate(cellA2);\n            assertEquals(\"2.0\", evaluateN.formatAsString());\n        }\n    }\n    @Test\n    public void testBug55843d() throws IOException {\n        try (Workbook wb = _testDataProvider.createWorkbook()) {\n            Sheet sheet = wb.createSheet(\"test\");\n            Row row = sheet.createRow(0);\n            Row row2 = sheet.createRow(1);\n            Cell cellA2 = row2.createCell(0, CellType.FORMULA);\n            Cell cellB1 = row.createCell(1, CellType.NUMERIC);\n            cellB1.setCellValue(10);\n            FormulaEvaluator formulaEvaluator = wb.getCreationHelper().createFormulaEvaluator();\n            cellA2.setCellFormula(\"IF(NOT(B1=0),((ROW())),\\\"\\\")\");\n            CellValue evaluateN = formulaEvaluator.evaluate(cellA2);\n            assertEquals(\"2.0\", evaluateN.formatAsString());\n        }\n    }\n    @Test\n    public void testBug55843e() throws IOException {\n        try (Workbook wb = _testDataProvider.createWorkbook()) {\n            Sheet sheet = wb.createSheet(\"test\");\n            Row row = sheet.createRow(0);\n            Row row2 = sheet.createRow(1);\n            Cell cellA2 = row2.createCell(0, CellType.FORMULA);\n            Cell cellB1 = row.createCell(1, CellType.NUMERIC);\n            cellB1.setCellValue(10);\n            FormulaEvaluator formulaEvaluator = wb.getCreationHelper().createFormulaEvaluator();\n            cellA2.setCellFormula(\"IF(B1=0,\\\"\\\",((ROW())))\");\n            CellValue evaluate = formulaEvaluator.evaluate(cellA2);\n            assertEquals(\"2.0\", evaluate.formatAsString());\n        }\n    }\n    @Test\n    public void testBug55843f() throws IOException {\n        try (Workbook wb = _testDataProvider.createWorkbook()) {\n            Sheet sheet = wb.createSheet(\"test\");\n            Row row = sheet.createRow(0);\n            Row row2 = sheet.createRow(1);\n            Cell cellA2 = row2.createCell(0, CellType.FORMULA);\n            Cell cellB1 = row.createCell(1, CellType.NUMERIC);\n            cellB1.setCellValue(10);\n            FormulaEvaluator formulaEvaluator = wb.getCreationHelper().createFormulaEvaluator();\n            cellA2.setCellFormula(\"IF(B1=0,\\\"\\\",IF(B1=10,3,4))\");\n            CellValue evaluate = formulaEvaluator.evaluate(cellA2);\n            assertEquals(\"3.0\", evaluate.formatAsString());\n        }\n    }\n    @Test\n    public void testBug56655() throws IOException {\n        try (Workbook wb = _testDataProvider.createWorkbook()) {\n            Sheet sheet = wb.createSheet();\n            setCellFormula(sheet, 0, 0, \"#VALUE!\");\n            setCellFormula(sheet, 0, 1, \"SUMIFS(A:A,A:A,#VALUE!)\");\n            wb.getCreationHelper().createFormulaEvaluator().evaluateAll();\n            assertEquals(CellType.ERROR, getCell(sheet, 0, 0).getCachedFormulaResultType());\n            assertEquals(FormulaError.VALUE.getCode(), getCell(sheet, 0, 0).getErrorCellValue());\n            assertEquals(CellType.ERROR, getCell(sheet, 0, 1).getCachedFormulaResultType());\n            assertEquals(FormulaError.VALUE.getCode(), getCell(sheet, 0, 1).getErrorCellValue());\n        }\n    }\n<fim_suffix>    @Test\n    public void testBug56655a() throws IOException {\n        try (Workbook wb = _testDataProvider.createWorkbook()) {\n            Sheet sheet = wb.createSheet();\n            setCellFormula(sheet, 0, 0, \"B1*C1\");\n            sheet.getRow(0).createCell(1).setCellValue(\"A\");\n            setCellFormula(sheet, 1, 0, \"B1*C1\");\n            sheet.getRow(1).createCell(1).setCellValue(\"A\");\n            setCellFormula(sheet, 0, 3, \"SUMIFS(A:A,A:A,A2)\");\n            wb.getCreationHelper().createFormulaEvaluator().evaluateAll();\n            assertEquals(CellType.ERROR, getCell(sheet, 0, 0).getCachedFormulaResultType());\n            assertEquals(FormulaError.VALUE.getCode(), getCell(sheet, 0, 0).getErrorCellValue());\n            assertEquals(CellType.ERROR, getCell(sheet, 1, 0).getCachedFormulaResultType());\n            assertEquals(FormulaError.VALUE.getCode(), getCell(sheet, 1, 0).getErrorCellValue());\n            assertEquals(CellType.ERROR, getCell(sheet, 0, 3).getCachedFormulaResultType());\n            assertEquals(FormulaError.VALUE.getCode(), getCell(sheet, 0, 3).getErrorCellValue());\n        }\n    }<fim_middle>// function below has no smell\n"}
{"text": "<fim_prefix> * the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\npackage org.apache.jmeter.assertions.gui;\nimport java.awt.BorderLayout;\nimport javax.swing.BorderFactory;\nimport javax.swing.Box;\nimport javax.swing.ButtonGroup;\nimport javax.swing.JCheckBox;\nimport javax.swing.JLabel;\nimport javax.swing.JPanel;\nimport javax.swing.JRadioButton;\nimport javax.swing.JTextField;\nimport org.apache.jmeter.assertions.SMIMEAssertionTestElement;\nimport org.apache.jmeter.testelement.TestElement;\nimport org.apache.jmeter.util.JMeterUtils;\nimport org.apache.jorphan.gui.layout.VerticalLayout;\n<fim_suffix> public class SMIMEAssertionGui extends AbstractAssertionGui {\n    private static final long serialVersionUID = 1L;\n    private final JCheckBox verifySignature =\n        new JCheckBox(JMeterUtils.getResString(\"smime_assertion_verify_signature\")); // $NON-NLS-1$\n    private final JCheckBox notSigned =\n        new JCheckBox(JMeterUtils.getResString(\"smime_assertion_not_signed\")); // $NON-NLS-1$\n    private final JRadioButton signerNoCheck =\n        new JRadioButton(JMeterUtils.getResString(\"smime_assertion_signer_no_check\")); // $NON-NLS-1$\n    private final JRadioButton signerCheckConstraints =\n        new JRadioButton(JMeterUtils.getResString(\"smime_assertion_signer_constraints\")); // $NON-NLS-1$\n    private final JRadioButton signerCheckByFile =\n        new JRadioButton(JMeterUtils.getResString(\"smime_assertion_signer_by_file\")); // $NON-NLS-1$\n    private final JTextField signerDnField = new JTextField(50);\n    private final JTextField signerSerialNumberField = new JTextField(25);\n    private final JTextField signerEmailField = new JTextField(25);\n    private final JTextField issuerDnField = new JTextField(50);\n    private final JTextField signerCertFile = new JTextField(25);\n    private final JTextField messagePositionTf = new JTextField(25);\n    public SMIMEAssertionGui() {\n        init();\n    }\n    @Override\n    public String getLabelResource() {\n        return \"smime_assertion_title\";\n    }\n    /**\n     * {@inheritDoc}\n     */\n    @Override\n    public void clearGui() {\n        super.clearGui();\n        issuerDnField.setText(\"\");\n        messagePositionTf.setText(\"\");\n        notSigned.setSelected(false);\n        signerCertFile.setText(\"\");\n        signerCheckByFile.setSelected(false);\n        signerCheckConstraints.setSelected(false);\n        signerDnField.setText(\"\");\n        signerEmailField.setText(\"\");\n        signerNoCheck.setSelected(false);\n        signerSerialNumberField.setText(\"\");\n    }\n    private void init() { // WARNING: called from ctor so must not be overridden (i.e. must be private or final)\n        setLayout(new BorderLayout());\n        setBorder(makeBorder());\n        Box box = Box.createVerticalBox();\n        box.add(makeTitlePanel());\n        box.add(createSignaturePanel());\n        box.add(createSignerPanel());\n        box.add(createMessagePositionPanel());\n        add(box, BorderLayout.NORTH);\n    }\n    private JPanel createSignaturePanel() {\n        JPanel panel = new JPanel();\n        panel.setBorder(BorderFactory.createTitledBorder(JMeterUtils\n            .getResString(\"smime_assertion_signature\"))); // $NON-NLS-1$\n        notSigned.addChangeListener(\n                evt -> verifySignature.setEnabled(!notSigned.isSelected()));\n        panel.add(verifySignature);\n        panel.add(notSigned);\n        return panel;\n    }\n    private JPanel createSignerPanel() {\n        JPanel panel = new JPanel();\n        panel.setBorder(BorderFactory.createTitledBorder(JMeterUtils\n            .getResString(\"smime_assertion_signer\"))); // $NON-NLS-1$\n        panel.setLayout(new VerticalLayout(5, VerticalLayout.LEFT));\n        ButtonGroup buttonGroup = new ButtonGroup();\n        buttonGroup.add(signerNoCheck);\n        buttonGroup.add(signerCheckConstraints);\n        buttonGroup.add(signerCheckByFile);\n        panel.add(signerNoCheck);\n        panel.add(signerCheckConstraints);\n        signerCheckConstraints.addChangeListener(evt -> {\n                boolean signerCC = signerCheckConstraints.isSelected();\n                signerDnField.setEnabled(signerCC);\n                signerSerialNumberField.setEnabled(signerCC);\n                signerEmailField.setEnabled(signerCC);\n                issuerDnField.setEnabled(signerCC);\n                });\n        Box box = Box.createHorizontalBox();\n        box.add(new JLabel(JMeterUtils.getResString(\"smime_assertion_signer_dn\"))); // $NON-NLS-1$\n        box.add(Box.createHorizontalStrut(5));\n        box.add(signerDnField);\n        panel.add(box);\n        box = Box.createHorizontalBox();\n        box.add(new JLabel(JMeterUtils.getResString(\"smime_assertion_signer_email\"))); // $NON-NLS-1$\n        box.add(Box.createHorizontalStrut(5));\n        box.add(signerEmailField);\n        panel.add(box);\n        box = Box.createHorizontalBox();\n        box.add(new JLabel(JMeterUtils.getResString(\"smime_assertion_issuer_dn\"))); // $NON-NLS-1$\n        box.add(Box.createHorizontalStrut(5));\n        box.add(issuerDnField);\n        panel.add(box);\n        box = Box.createHorizontalBox();\n        box.add(new JLabel(JMeterUtils.getResString(\"smime_assertion_signer_serial\"))); // $NON-NLS-1$\n        box.add(Box.createHorizontalStrut(5));\n        box.add(signerSerialNumberField);\n        panel.add(box);\n        signerCheckByFile.addChangeListener(\n                evt -> signerCertFile.setEnabled(signerCheckByFile.isSelected()));\n        box = Box.createHorizontalBox();\n        box.add(signerCheckByFile);\n        box.add(Box.createHorizontalStrut(5));\n        box.add(signerCertFile);\n        panel.add(box);\n        return panel;\n    }\n    private JPanel createMessagePositionPanel(){\n        JPanel panel = new JPanel();\n        panel.setBorder(BorderFactory.createTitledBorder(JMeterUtils\n            .getResString(\"smime_assertion_message_position\"))); // $NON-NLS-1$\n        panel.add(messagePositionTf);\n        return panel;\n    }\n    @Override\n    public void configure(TestElement el) {\n        super.configure(el);\n        SMIMEAssertionTestElement smimeAssertion = (SMIMEAssertionTestElement) el;\n        verifySignature.setSelected(smimeAssertion.isVerifySignature());\n        notSigned.setSelected(smimeAssertion.isNotSigned());\n        if (smimeAssertion.isSignerNoCheck()) {\n            signerNoCheck.setSelected(true);\n        }\n        if (smimeAssertion.isSignerCheckConstraints()) {\n            signerCheckConstraints.setSelected(true);\n        }\n        if (smimeAssertion.isSignerCheckByFile()) {\n            signerCheckByFile.setSelected(true);\n        }\n        issuerDnField.setText(smimeAssertion.getIssuerDn());\n        signerDnField.setText(smimeAssertion.getSignerDn());\n        signerSerialNumberField.setText(smimeAssertion.getSignerSerial());\n        signerEmailField.setText(smimeAssertion.getSignerEmail());\n        signerCertFile.setText(smimeAssertion.getSignerCertFile());\n        messagePositionTf.setText(smimeAssertion.getSpecificMessagePosition());\n    }\n    @Override\n    public void modifyTestElement(TestElement el) {\n        configureTestElement(el);\n        SMIMEAssertionTestElement smimeAssertion = (SMIMEAssertionTestElement) el;\n        smimeAssertion.setVerifySignature(verifySignature.isSelected());\n        smimeAssertion.setNotSigned(notSigned.isSelected());\n        smimeAssertion.setIssuerDn(issuerDnField.getText());\n        smimeAssertion.setSignerDn(signerDnField.getText());\n        smimeAssertion.setSignerSerial(signerSerialNumberField.getText());\n        smimeAssertion.setSignerEmail(signerEmailField.getText());\n        smimeAssertion.setSignerCertFile(signerCertFile.getText());\n        smimeAssertion.setSignerNoCheck(signerNoCheck.isSelected());\n        smimeAssertion.setSignerCheckConstraints(signerCheckConstraints.isSelected());\n        smimeAssertion.setSignerCheckByFile(signerCheckByFile.isSelected());\n        smimeAssertion.setSpecificMessagePosition(messagePositionTf.getText());\n    }\n    @Override\n    public TestElement createTestElement() {\n        SMIMEAssertionTestElement smimeAssertion = new SMIMEAssertionTestElement();\n        modifyTestElement(smimeAssertion);\n        return smimeAssertion;\n    }\n}<fim_middle>// class below has no smell\n"}